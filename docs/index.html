<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Compartilhamento Acadêmico</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        header {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 20px;
        }

        main {
            padding: 20px;
        }

        section {
            margin-bottom: 20px;
        }

        nav {
            background-color: #eee;
            padding: 10px;
        }

        nav a {
            text-decoration: none;
            color: #333;
            margin: 0 10px;
        }

        .panel {
            display: none;
        }
        .panel-content {
            display: flex;
            flex-wrap: wrap;
        }

        .record-list {
            flex: 1;
            margin-right: 20px;
        }

        .requests-section,
        .permissions-section {
            flex: 1;
        }

        .panel-content {
            display: flex;
            flex-wrap: wrap;
        }

        .record-list {
            flex: 1;
            margin-right: 20px;
        }

        .requests-section,
        .permissions-section {
            flex: 1;
        }
        .panel-content {
            display: flex;
            flex-wrap: wrap;
        }

        .record-list {
            flex: 1;
            margin-right: 20px;
        }

        .verification-section {
            flex: 1;
        }
    </style>
</head>

<body>
    <header>
        <h1>Sistema de Compartilhamento Acadêmico</h1>
        <p>Uma plataforma blockchain para gerenciamento e compartilhamento de registros acadêmicos.</p>
    </header>

    <main>
        <section>
            <h2>Visão Geral</h2>
            <p>Bem-vindo ao Sistema de Compartilhamento Acadêmico! Este sistema utiliza tecnologia blockchain para garantir a segurança e autenticidade dos registros acadêmicos. Oferecemos uma maneira eficiente e transparente de compartilhar e verificar informações acadêmicas.</p>
        </section>

        <nav>
            <a href="#" onclick="showPanel('aluno')">Painel do Aluno</a>
            <a href="#" onclick="showPanel('instituicao')">Painel da Instituição</a>
            <a href="#" onclick="showPanel('verificador')">Painel do Verificador</a>
        </nav>

        <section id="aluno" class="panel">
            <h2>Painel do Aluno</h2>
            <p>Bem-vindo ao Painel do Aluno! Aqui você pode acessar seus registros acadêmicos e gerenciar solicitações de compartilhamento.</p>
            
                <div class="panel-content">
                    <div class="record-list">
                    <h3>Visualização de Registros</h3>
                    <!-- Adicione a lista de registros acadêmicos aqui -->
                    <ul>
                        <li>
                            <strong>Disciplina:</strong> Matemática
                            <br>
                            <strong>Instituição:</strong> Universidade ABC
                        </li>
                        <li>
                            <strong>Disciplina:</strong> História
                            <br>
                            <strong>Instituição:</strong> Faculdade XYZ
                        </li>
                        <li>
                            <strong>Disciplina:</strong> Programação Avançada
                            <br>
                            <strong>Instituição:</strong> Instituto 123
                        </li>
                        <!-- Adicione mais registros conforme necessário -->
                    </ul>
                </div>

                <div class="requests-section">
                    <h3>Solicitações de Compartilhamento</h3>
                    <!-- Adicione a seção de solicitações de compartilhamento aqui -->
                    <ul>
                        <li>Solicitação 1 - Pendente</li>
                        <li>Solicitação 2 - Aprovada</li>
                        <li>Solicitação 3 - Rejeitada</li>
                        <!-- Adicione mais solicitações conforme necessário -->
                    </ul>
                </div>

                <div class="permissions-section">
                    <h3>Configurações de Permissões</h3>
                    <!-- Adicione a seção de configurações de permissões aqui -->
                    <p>Gerencie suas permissões de emissão de registros acadêmicos aqui.</p>
                </div>
            </div>
        </section>

        <section id="instituicao" class="panel">
            <h2>Painel da Instituição</h2>
             <p>Bem-vindo ao Painel da Instituição! Aqui você pode solicitar emissão de registros acadêmicos e gerenciar solicitações de compartilhamento recebidas.</p>
            

            <!-- Seção de Emissão de Registros Acadêmicos -->
                <div class="record-issuance">
                    <h3>Emissão de Registros Acadêmicos</h3>
                    <form id="emissaoForm">
                        <label for="aluno">Aluno:</label>
                        <input type="text" id="aluno" name="aluno" required>

                        <label for="curso">Curso:</label>
                        <input type="text" id="curso" name="curso" required>

                        <!-- Adicione mais campos conforme necessário -->

                        <button type="button" onclick="emitirRegistro()">Emitir Registro</button>
                    </form>
                </div>

                <div class="requests-section">
                    <h3>Solicitações de Compartilhamento</h3>
                    <!-- Seção para rastrear solicitações de compartilhamento -->
                    <ul>
                        <li>Solicitação 1 - Pendente</li>
                        <li>Solicitação 2 - Aprovada</li>
                        <li>Solicitação 3 - Rejeitada</li>
                        <!-- Adicione mais solicitações conforme necessário -->
                    </ul>
                </div>

                <div class="permissions-section">
                    <h3>Configurações de Permissões</h3>
                    <!-- Área para gerenciar configurações de permissões -->
                    <p>Gerencie as permissões de emissão de registros acadêmicos aqui.</p>
                </div>
            </div>
            <script src="https://cdn.jsdelivr.net/npm/web3@1.3.6/dist/web3.min.js"></script>

            <script>
                // Use o provedor Web3, por exemplo, o MetaMask
                const web3 = new Web3(Web3.givenProvider);

                // Substitua pelo endereço do seu contrato
                const contractAddress = "0x93f8dddd876c7dBE3323723500e83E202A7C96CC";
                
                // Substitua pelo ABI do seu contrato
                const contractABI = [
                    {
                        "anonymous": false,
                        "inputs": [
                            {
                                "indexed": true,
                                "internalType": "address",
                                "name": "instituicao",
                                "type": "address"
                            },
                            {
                                "indexed": false,
                                "internalType": "string",
                                "name": "nomeAluno",
                                "type": "string"
                            },
                            {
                                "indexed": true,
                                "internalType": "uint256",
                                "name": "matricula",
                                "type": "uint256"
                            },
                            {
                                "indexed": false,
                                "internalType": "string",
                                "name": "curso",
                                "type": "string"
                            },
                            {
                                "indexed": false,
                                "internalType": "uint256",
                                "name": "nota",
                                "type": "uint256"
                            },
                            {
                                "indexed": false,
                                "internalType": "bool",
                                "name": "emitido",
                                "type": "bool"
                            }
                        ],
                        "name": "LogEstadoContrato",
                        "type": "event"
                    },
                    {
                        "inputs": [],
                        "name": "afterAll",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "beforeAll",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "testeConcederPermissaoDeEmissao",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "testeEmitirRegistroAcademico",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "testeRevogarPermissaoDeEmissao",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    },
                    {
                        "inputs": [],
                        "name": "testeVerificarRegistroAposEmissao",
                        "outputs": [],
                        "stateMutability": "nonpayable",
                        "type": "function"
                    }
                ];

                const contract = new web3.eth.Contract(contractABI, contractAddress);

                // Função para emitir um registro acadêmico
                async function emitirRegistro() {
                    const aluno = document.getElementById("aluno").value;
                    const curso = document.getElementById("curso").value;

                    // Use a função do contrato para emitir um registro
                    await contract.methods.emitirRegistro(aluno, curso).send({ from: web3.currentProvider.selectedAddress });

                    // Atualize a lista de solicitações pendentes
                    exibirSolicitacoesPendentes();
                }

                // Lógica para recuperar e exibir as solicitações pendentes
                async function exibirSolicitacoesPendentes() {
                    const solicitacoesList = document.getElementById("solicitacoesList");

                    // Limpe a lista existente
                    solicitacoesList.innerHTML = "";

                    // Use a função do contrato para recuperar as solicitações pendentes
                    const solicitacoes = await contract.methods.getSolicitacoesPendentes().call();

                    // Exibir as solicitações na lista
                    solicitacoes.forEach(solicitacao => {
                        const listItem = document.createElement("li");
                        listItem.textContent = solicitacao;
                        solicitacoesList.appendChild(listItem);
                    });
                }

                // Atualizar automaticamente a lista de solicitações pendentes a cada intervalo (por exemplo, 30 segundos)
                setInterval(exibirSolicitacoesPendentes, 30000);

                // Atualizar a lista de solicitações pendentes quando a página for carregada
                document.addEventListener("DOMContentLoaded", function () {
                    exibirSolicitacoesPendentes();
                });
            </script>
        </section>
        <section id="verificador" class="panel">
            <h2>Painel do Verificador</h2>
            <p>Bem-vindo ao Painel do Verificador! Aqui você pode verificar a autenticidade dos registros acadêmicos.</p>
        

            <div class="panel-content">
                <div class="record-list">
                    <h3>Registros Acadêmicos</h3>
                    <!-- Lista de registros acadêmicos disponíveis para verificação -->
                    <ul>
                        <li>
                            <strong>Disciplina:</strong> Matemática
                            <br>
                            <strong>Aluno:</strong> João da Silva
                            <br>
                            <strong>Matrícula:</strong> 123456
                        </li>
                        <li>
                            <strong>Disciplina:</strong> História
                            <br>
                            <strong>Aluno:</strong> Maria Oliveira
                            <br>
                            <strong>Matrícula:</strong> 789012
                        </li>
                        <li>
                            <strong>Disciplina:</strong> Programação Avançada
                            <br>
                            <strong>Aluno:</strong> Carlos Souza
                            <br>
                            <strong>Matrícula:</strong> 345678
                        </li>
                        <!-- Adicione mais registros conforme necessário -->
                    </ul>
                </div>

                <div class="verification-section">
                    <h3>Verificação de Registros</h3>
                    <!-- Área para realizar verificações de registros -->
                    <p>Insira o identificador único do registro abaixo para verificar sua autenticidade:</p>
                    <input type="text" id="matriculaVerificacao" placeholder="Matrícula">
                    <button onclick="realizarVerificacao()">Verificar</button>

                    <!-- Local para exibir o resultado da verificação -->
                    <p id="resultadoVerificacao"></p>
                </div>
            </div>
        </section>

        <!-- O restante do HTML e o script JavaScript permanecem inalterados -->
        <script>
            // Função para emitir um registro acadêmico
            function emitirRegistro() {
                // Lógica para interagir com o contrato inteligente e emitir um registro
                // Atualizar a lista de solicitações pendentes após a emissão, se necessário
            }

            // Lógica para recuperar e exibir as solicitações pendentes
            function exibirSolicitacoesPendentes() {
                // Lógica para recuperar as solicitações pendentes da blockchain
                // Exibir as solicitações na lista #solicitacoesList
            }

            // Atualizar a lista de solicitações pendentes quando a página for carregada
            document.addEventListener("DOMContentLoaded", function () {
                exibirSolicitacoesPendentes();
            });
        </script>
        <script>
            function realizarVerificacao() {
                // Lógica de verificação aqui
                // Exemplo: Recuperar o identificador único inserido e verificar no contrato inteligente

                // Exibindo o resultado da verificação (pode ser "Autêntico" ou "Não autêntico")
                document.getElementById("resultadoVerificacao").innerText = "Autêntico";
            }
        </script>

        
    </main>

    <script>
        function showPanel(panelId) {
            // Oculta todos os painéis
            var panels = document.querySelectorAll('.panel');
            panels.forEach(function (panel) {
                panel.style.display = 'none';
            });

            // Exibe o painel correspondente ao clicar no menu
            var selectedPanel = document.getElementById(panelId);
            if (selectedPanel) {
                selectedPanel.style.display = 'block';
            }
        }
    </script>
</body>

</html>
